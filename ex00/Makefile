NAME = Polymorphism

# Source files
SOURCE_FOLDER = src/
SOURCE_FILES = main.cpp \
				Animal.cpp \
				Cat.cpp \
				Dog.cpp \
				WrongAnimal.cpp \
				WrongCat.cpp

SOURCES = $(addprefix $(SOURCE_FOLDER), $(SOURCE_FILES))

# Objects
OBJECTS= $(SOURCE_FILES:.cpp=.o)
# OBJECTS = $(addprefix $(OBJECT_FOLDER), $(OBJECT_FILES))

# Headers
HEADERS_FOLDER	= include/

# Flags and output
CXXFLAGS = -Wall -Wextra -Werror -Wno-c++0x-compat -std=c++98

all: $(NAME)

# Rule to build your object files and link them into a binary
$(NAME): $(OBJECTS)
	@echo "üöß Compiling binary... üöß"
	@c++ $(OBJECTS) -o $(NAME)
	@echo "‚úÖ Done!"

#objects
$(OBJECTS):
	@echo "üöß Compiling objects... üöß"
	@c++  -c $(SOURCES) $(CXXCFLAGS) -I$(HEADERS_FOLDER)
	@echo "‚úÖ Done!"
# Rule to remove object files
clean:
	@echo "üßπ Deleting objects..."
	@rm -f $(OBJECTS)
	@echo "üßπ Deleting leaks reports..."
	@rm -f leaks.$(NAME).txt
	@echo "‚úÖ Done!"
# Rule to remove binary, calls the 'clean' rule first
fclean: clean
	@rm -f $(NAME)
	@echo "üßπ Deleting binary named $(NAME)"

# Rule to remove object files and binary, then re-build everything
re:	fclean all

# Rule to test norminette
normi:	
	@cpplint --root=include $(SOURCES) $(HEADERS_FOLDER)*

# Rule to debug, include norminette and similars
test: re
	@echo "‚ö°Ô∏èBinary execution‚ö°Ô∏è\n"
	@./$(NAME)
	@echo "\nüõ°Ô∏èValgrind executionüõ°Ô∏è\n"
	@valgrind \
	--leak-check=full \
	--show-leak-kinds=all \
	--verbose \
	--log-file=leaks.$(NAME).txt \
	./$(NAME) 
	@echo "\nüìöValgrind summaryüìö\nCheck leaks.$(NAME).txt for a detailed report."
	@cat leaks.$(NAME).txt | grep 'ERROR SUMMARY'
